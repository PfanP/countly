(function(t){var c={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(c,t){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+t.color+';">'+c+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};t.plot.plugins.push({init:function(u){function H(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       b,h,f){C||(C=!0,l=a.getCanvas(),v=t(l).parent(),c=a.getOptions(),a.setData(I(a.getData())))}function I(a){for(var b=0;b<a.length;++b)if("number"==typeof a[b].data)a[b].data=[[1,a[b].data]];else if("undefined"==typeof a[b].data||"undefined"==typeof a[b].data[0])"undefined"!=typeof a[b].data&&"undefined"!=typeof a[b].data.label&&(a[b].label=a[b].data.label),a[b].data=[[1,0]];for(var b=a,h=0;h<b.length;++h){var f=parseFloat(b[h].data[0][1]);f&&(n+=f)}for(var h=b=0,f=c.series.pie.combine.color,e=[],d=
    0;d<a.length;++d)a[d].data[0][1]=parseFloat(a[d].data[0][1]),a[d].data[0][1]||(a[d].data[0][1]=0),a[d].data[0][1]/n<=c.series.pie.combine.threshold?(b+=a[d].data[0][1],h++,f||(f=a[d].color)):e.push({data:[[1,a[d].data[0][1]]],color:a[d].color,label:a[d].label,angle:2*a[d].data[0][1]*Math.PI/n,percent:a[d].data[0][1]/n*100});0<h&&e.push({data:[[1,b]],color:f,label:c.series.pie.combine.label,angle:2*b*Math.PI/n,percent:b/n*100});return e}function J(a,b){function h(){ctx.clearRect(0,0,l.width,l.height);
    v.children().filter(".pieLabel, .pieLabelBackground").remove()}function f(){var a=1<c.series.pie.radius?c.series.pie.radius:p*c.series.pie.radius;if(!(a>=l.width/2-5||a*c.series.pie.tilt>=l.height/2-15||10>=a)){ctx.save();ctx.translate(5,15);ctx.globalAlpha=0.02;ctx.fillStyle="#000";ctx.translate(m,z);ctx.scale(1,c.series.pie.tilt);for(var b=1;10>=b;b++)ctx.beginPath(),ctx.arc(0,0,a,0,2*Math.PI,!1),ctx.fill(),a-=b;ctx.restore()}}function e(){function a(b,c,d){0>=b||(d?ctx.fillStyle=c:(ctx.strokeStyle=
    c,ctx.lineJoin="round"),ctx.beginPath(),1E-9<Math.abs(b-2*Math.PI)?ctx.moveTo(0,0):t.browser.msie&&(b-=1E-4),ctx.arc(0,0,h,e,e+b,!1),ctx.closePath(),e+=b,d?ctx.fill():ctx.stroke())}function b(){for(var a=startAngle,h=1<c.series.pie.label.radius?c.series.pie.label.radius:p*c.series.pie.label.radius,e=0;e<d.length;++e){if(d[e].percent>=100*c.series.pie.label.threshold){var f=d[e],g=a,s=e;if(0!=f.data[0][1]){var q=c.legend.labelFormatter,k=void 0,r=c.series.pie.label.formatter,k=q?q(f.label,f):f.label;
    r&&(k=r(k,f));q=(g+f.angle+g)/2;g=m+Math.round(Math.cos(q)*h);q=z+Math.round(Math.sin(q)*h)*c.series.pie.tilt;v.append('<span class="pieLabel" id="pieLabel'+s+'" style="position:absolute;top:'+q+"px;left:"+g+'px;">'+k+"</span>");s=v.children("#pieLabel"+s);k=q-s.height()/2;q=g-s.width()/2;s.css("top",k);s.css("left",q);if(0<0-k||0<0-q||0>l.height-(k+s.height())||0>l.width-(q+s.width()))A=!0;0!=c.series.pie.label.background.opacity&&(g=c.series.pie.label.background.color,null==g&&(g=f.color),f="top:"+
        k+"px;left:"+q+"px;",t('<div class="pieLabelBackground" style="position:absolute;width:'+s.width()+"px;height:"+s.height()+"px;"+f+"background-color:"+g+';"> </div>').insertBefore(s).css("opacity",c.series.pie.label.background.opacity))}}a+=d[e].angle}}startAngle=Math.PI*c.series.pie.startAngle;var h=1<c.series.pie.radius?c.series.pie.radius:p*c.series.pie.radius;ctx.save();ctx.translate(m,z);ctx.scale(1,c.series.pie.tilt);ctx.save();for(var e=startAngle,f=0;f<d.length;++f)d[f].startAngle=e,a(d[f].angle,
    d[f].color,!0);ctx.restore();ctx.save();ctx.lineWidth=c.series.pie.stroke.width;e=startAngle;for(f=0;f<d.length;++f)a(d[f].angle,c.series.pie.stroke.color,!1);ctx.restore();D(ctx);c.series.pie.label.show&&b();ctx.restore()}if(v){ctx=b;B=v.children().filter(".legend").children().width();p=Math.min(l.width,l.height/c.series.pie.tilt)/2;z=l.height/2+c.series.pie.offset.top;m=l.width/2;m="auto"==c.series.pie.offset.left?c.legend.position.match("w")?m+B/2:m-B/2:m+c.series.pie.offset.left;m<p?m=p:m>l.width-
    p&&(m=l.width-p);var d=a.getData(),k=0;for(A=!0;A&&k<E;)A=!1,0<k&&(p*=K),k+=1,h(),0.8>=c.series.pie.tilt&&f(),e();k>=E&&(h(),v.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>'));a.setSeries&&a.insertLegend&&(a.setSeries(d),a.insertLegend())}}function D(a){0<c.series.pie.innerRadius&&(a.save(),innerRadius=1<c.series.pie.innerRadius?c.series.pie.innerRadius:p*c.series.pie.innerRadius,a.globalCompositeOperation="destination-out",a.beginPath(),a.fillStyle=c.series.pie.stroke.color,
    a.arc(0,0,innerRadius,0,2*Math.PI,!1),a.fill(),a.closePath(),a.restore(),a.save(),a.beginPath(),a.strokeStyle=c.series.pie.stroke.color,a.arc(0,0,innerRadius,0,2*Math.PI,!1),a.stroke(),a.closePath(),a.restore())}function L(a){F("plothover",a)}function M(a){F("plotclick",a)}function F(a,b){var h=u.offset(),f=parseInt(b.pageX-h.left);a:{for(var h=parseInt(b.pageY-h.top),e=u.getData(),d=u.getOptions(),d=1<d.series.pie.radius?d.series.pie.radius:p*d.series.pie.radius,k=0;k<e.length;++k){var g=e[k];if(g.pie.show){ctx.save();
    ctx.beginPath();ctx.moveTo(0,0);ctx.arc(0,0,d,g.startAngle,g.startAngle+g.angle,!1);ctx.closePath();x=f-m;y=h-z;if(ctx.isPointInPath){if(ctx.isPointInPath(f-m,h-z)){ctx.restore();f={datapoint:[g.percent,g.data],dataIndex:0,series:g,seriesIndex:k};break a}}else{p1X=d*Math.cos(g.startAngle);p1Y=d*Math.sin(g.startAngle);p2X=d*Math.cos(g.startAngle+g.angle/4);p2Y=d*Math.sin(g.startAngle+g.angle/4);p3X=d*Math.cos(g.startAngle+g.angle/2);p3Y=d*Math.sin(g.startAngle+g.angle/2);p4X=d*Math.cos(g.startAngle+
        g.angle/1.5);p4Y=d*Math.sin(g.startAngle+g.angle/1.5);p5X=d*Math.cos(g.startAngle+g.angle);p5Y=d*Math.sin(g.startAngle+g.angle);arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]];arrPoint=[x,y];for(var l=!1,w=-1,t=arrPoly.length,n=t-1;++w<t;n=w)(arrPoly[w][1]<=arrPoint[1]&&arrPoint[1]<arrPoly[n][1]||arrPoly[n][1]<=arrPoint[1]&&arrPoint[1]<arrPoly[w][1])&&arrPoint[0]<(arrPoly[n][0]-arrPoly[w][0])*(arrPoint[1]-arrPoly[w][1])/(arrPoly[n][1]-arrPoly[w][1])+arrPoly[w][0]&&(l=!l);if(l){ctx.restore();
        f={datapoint:[g.percent,g.data],dataIndex:0,series:g,seriesIndex:k};break a}}ctx.restore()}}f=null}if(c.grid.autoHighlight)for(h=0;h<r.length;++h)e=r[h],e.auto!=a||f&&e.series==f.series||(e=e.series,null==e&&(r=[],u.triggerRedrawOverlay()),"number"==typeof e&&(e=series[e]),e=G(e),-1!=e&&(r.splice(e,1),u.triggerRedrawOverlay()));f&&(h=f.series,"number"==typeof h&&(h=series[h]),e=G(h),-1==e?(r.push({series:h,auto:a}),u.triggerRedrawOverlay()):a||(r[e].auto=!1));v.trigger(a,[{pageX:b.pageX,pageY:b.pageY},
    f])}function G(a){for(var b=0;b<r.length;++b)if(r[b].series==a)return b;return-1}function N(a,b){var c=a.getOptions(),f=1<c.series.pie.radius?c.series.pie.radius:p*c.series.pie.radius;b.save();b.translate(m,z);b.scale(1,c.series.pie.tilt);for(i=0;i<r.length;++i){var e=r[i].series;0>e.angle||(b.fillStyle="rgba(255, 255, 255, "+c.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(e.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,f,e.startAngle,e.startAngle+e.angle,!1),b.closePath(),b.fill())}D(b);
    b.restore()}var l=null,v=null,p=null,m=null,z=null,n=0,A=!0,E=10,K=0.95,B=0,C=!1,r=[];u.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?0.75:1),1<b.series.pie.tilt&&(b.series.pie.tilt=1),0>b.series.pie.tilt&&(b.series.pie.tilt=0),a.hooks.processDatapoints.push(H),a.hooks.drawOverlay.push(N),a.hooks.draw.push(J))});u.hooks.bindEvents.push(function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     b){var c=a.getOptions();c.series.pie.show&&c.grid.hoverable&&b.unbind("mousemove").mousemove(L);c.series.pie.show&&c.grid.clickable&&b.unbind("click").click(M)})},options:c,name:"pie",version:"1.0"})})(jQuery);